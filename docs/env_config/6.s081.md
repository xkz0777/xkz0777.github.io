# MIT 6.S081 实验环境配置

所做实验版本是 FA20

遇到两个问题：

- `make qemu` 报错：

  ```
  user/sh.c:58:1: error: infinite recursion detected [-Werror=infinite-recursion]
  58 | runcmd(struct cmd *cmd)
  ```

  解决：在 `CFLAGS` 中加上 `-Wno-error=infinite-recursion`

- `make qemu` 启动 qemu 时，卡在

  ```bash
  qemu-system-riscv64 -machine virt -bios none -kernel kernel/kernel -m 128M -smp 3 -nographic -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0
  ```

  没有出现 `$ ` 这样的 prompt，也无法输入指令。

  解决：按照 [官方文档](https://pdos.csail.mit.edu/6.S081/2020/tools.html) 的说法，`qemu-system-misc` 包经过更新后和 Kernel 不兼容，但按照文档指令 `sudo apt-get install qemu-system-misc=1:4.2-3ubuntu6` 又找不到包，最后按照 [stackoverflow](https://stackoverflow.com/questions/66718225/qemu-system-riscv64-is-not-found-in-package-qemu-system-misc) 的做法，手动编译 qemu 才可。
